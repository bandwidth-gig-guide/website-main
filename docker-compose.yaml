services:
  db-main:
    image: ghcr.io/bandwidth-gig-guide/db-main:latest
    container_name: db-main
    volumes:
      - db-main-data:/var/lib/postgresql/data
    networks:
      - network-bandwidth

  service-public:
    image: ghcr.io/bandwidth-gig-guide/service-public:latest
    container_name: service-public
    networks:
      - network-bandwidth

  service-admin:
    image: ghcr.io/bandwidth-gig-guide/service-admin:latest
    container_name: service-admin
    networks:
      - network-bandwidth

  website-main:
    build:
      context: .
      dockerfile: ./Dockerfile
    container_name: website-main
    networks:
      - network-bandwidth
    environment:
      - NODE_ENV=dev
    volumes:
      - ./app:/app
      - /app/node_modules

  website-admin:
    image: ghcr.io/bandwidth-gig-guide/website-admin:latest
    container_name: website-admin
    networks:
      - network-bandwidth

  api-gateway:
    image: ghcr.io/bandwidth-gig-guide/api-gateway:latest
    container_name: api-gateway
    depends_on:
      - service-public
      - service-admin
      - website-main
      - website-admin
    ports:
      - "80:80"
    networks:
      - network-bandwidth

volumes:
  db-main-data:

networks:
  network-bandwidth:
    driver: bridge
